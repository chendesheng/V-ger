<html ng-app="vger">
<head>
	<title>V'ger</title>
	<link href="/assets/angular-ui.css" rel="stylesheet" type="text/css"></link>
	<link href="/assets/style.css" rel="stylesheet" type="text/css">
	<script src="/assets/angular.js"></script>
	<script src="/assets/angular-animate.js"></script>
	<script src="/assets/angular-ui.js"></script>
	<script type="text/javascript" src="/assets/main.js"></script>
	<script type="text/javascript" src="/assets/date.js"></script>
</head>
<body ng-controller="tasks_ctrl">

	<div id="tasks">

		<div class="box-tasks-list">
 			<h1>V'ger</h1>
			<h2>Speed is Fun!</h2> 
			<ul id="tasks-list">
			<li>
				
	<div id="configs">
		<ul>
			<li>
				<label for="">Speed</label>
				<select  ng-model="config['max-speed']" class="action-limit" ui-event="{change:'send_limit($event)'}">
	   				<option value="0">No limit</option>
	   				<option value="50">50K</option>
	   				<option value="100">100K</option>
	   				<option value="150">150K</option>
	   				<option value="200">200K</option>
	   				<option value="300">300K</option>
	   				<option value="500">500K</option>
				</select>
			</li>
			<li>
				<label for="">Shutdown after finish</label>
				<input type="checkbox" ng-model="config['shutdown-after-finish']" ng-click="set_autoshutdown()">
			</li>
			<li>
				<label for="">Simultaneous</label>
				<select ng-model="config['simultaneous-downloads']" ui-event="{change:'send_simultaneous_downloads($event)'}">
					<option value="1">1</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5</option>
				</select>
			</li>
		</ul>
	</div>
	
			</li>
		       <li ng-repeat="task in tasks | orderBy:'StartTime':1" class="task">
		       		<div class="task-infoes">
		       			<div class="left-actions">
			       			<button class="resume" ng-click="send_resume(task)" ng-show="task.Status=='Stopped' || task.Status=='Playing'"></button>
			       			<button class="stop" ng-click="send_stop(task)" ng-show="task.Status=='Downloading'"></button>
			       			<button class="stop" ng-click="send_stop(task)" ng-show="task.Status=='Queued'"></button>
			       		</div>
		       			<div>
		       				<div class="name">
		       					<span ng-show="task.Status=='Queued'">[Waiting] </span><a title="{{task.Name}}" ng-click="$event.preventDefault();send_open(task);" href="{{task.URL}}">{{task.Name}}</a>
		       				</div>
		       			</div>
						
						<div class="progress-box">
					       	<div class="progress" ng-hide="task.Status=='Finished'">
					       		<div ng-class="{downloading:task.Status=='Downloading',stopped:task.Status!='Downloading'}" style="width:{{(task.DownloadedSize/task.Size*450).toFixed(0)}}px;"></div>
							</div>
						</div>

			       		<div class="row-3rd">
			       			<input type="button" ng-click="search_subtitles(task.Name)" value="S"/>
			       			<input type="button" ng-click="send_play(task)" value="P" ng-show="task.Status!='Finished'"/>

			       			<!-- <span ng-hide="task.Status=='Finished'">
				       			<input id="autoshutdown-{{task.NameHash}}" type="checkbox" ng-model="task.Autoshutdown" ng-click="set_autoshutdown(task)" />
				       			<label for="autoshutdown-{{task.NameHash}}">Shutdown after finish</label>
			       			</span> -->

			       			<span ng-show="task.Status=='Downloading'" class="info">Est. {{parse_duration(task.Est)}}</span>
			       			<span ng-show="task.Status=='Downloading' || task.Status=='Playing'" class="info">{{task.Speed.toFixed(0)}}KB/s</span>
							<!-- 
				       		<span ng-show="task.Status!='Downloading'" class="elapsed info">Elapsed. {{parse_duration(task.ElapsedTime)}}</span>
				       		<span ng-show="task.Status!='Downloading'" class="info">{{parse_time(task.StartTime)}}</span> -->

			       		</div>

		       			<!-- <div>
				       		<span style="display:none;">[{{task.StartDate.format()}}]</span>
				       		<span style="display:none;" class="elapsed">Elapsed. {{parse_duration(task.ElapsedTime)}}</span>
				       	</div> -->

		       			<button class="close" ng-click="move_to_trash(task)" title="Trash"></button>
		       		<div>
		       </li>
			</ul>
		</div>

		<form  ng-submit="go()">
			<div id="start-download" ui-event="{drop:'upload_torrent($event)'}" ondragover="return;">
				<textarea ui-keypress="{enter: '$event.preventDefault();go();'}" autofocus ng-model="new_url" type="text" id="new-url" placeHolder="Input anything you want"></textarea>
				<input id="new-task" type="submit" ng-hide="waiting" value="Go"/>
				<span ng-show="waiting" id="waiting"></span>
			</div>
		</form>
		
		<div id="box-overlay" style="display:none;" ng-show="bt_files.length > 0||nosubtitles||subtitles.length > 0||alerts.length>0">
			<div id="bt-files-overlay" class="overlay" ng-show="bt_files.length > 0">
				<div id="bt-files" class="popup">
					<button class="close" ng-click="bt_files=[]"></button>
					<h3>Select a file ({{bt_files.length}} files total)</h3>
					<ul>
						<li ng-repeat="file in bt_files | orderBy:-Size">
							<span class="status">[{{get_bt_file_status(file.Percent)}}]</span>
							<span class="name">{{file.Name}}</span>
							<span class="size">{{file.Size}}</span>
							<input type="button" value="Download" ng-disabled="file.Percent<100" ng-hide="file.loading" ng-click="download_bt_files(file)"/>
							<span class="loading" ng-show="file.loading"></span>
						</li>
					</ul>
				</div>
			</div>


			<div id="nosubtitles-overlay" class="overlay" ng-show="nosubtitles">
				<div class="popup">
					<button class="close" ng-click="nosubtitles=false"></button>
					<h3>No subtitles for '{{subtitles_movie_name}}'</h3>
					<div class="bottom"><input type="button" value="Search in Addic7ed" ng-click="addic7ed_subtitles()"/></div>
				</div>
			</div>

			<div id="subtitles-overlay" class="overlay" ng-show="subtitles.length > 0">
				<div id="subtitles" class="popup">
					<button class="close" ng-click="subtitles=[]"></button>
					<h3>Subtitles for '{{subtitles_movie_name}}'</h3>
					<ul>
						<li ng-repeat="sub in subtitles | orderBy:-Size">
							<span class="{{sub.Source}} icon"></span>
							<span class="name" title="{{sub.FullDescription}}">{{sub.Description}}</span>
							<input type="button" value="Download" ng-hide="sub.loading" ng-click="download_subtitles(sub)"/>
							<span class="loading" ng-show="sub.loading"></span>
						</li>
					</ul>
				</div>
			</div>


			<div class="overlay" ng-repeat="a in alerts" ng-show="alerts.length>0">
				<div class="popup alert">
					<button class="close" ng-click="pop_alert()"></button>
					<h3>{{a.title}}</h3>
					<div class="content">{{a.content}}</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>